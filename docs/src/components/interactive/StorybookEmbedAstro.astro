---
import {StorybookEmbed} from './StorybookEmbed.tsx'
import type {StorybookEmbedProps} from './StorybookEmbed.tsx'

interface Props extends Omit<StorybookEmbedProps, 'className'> {
  /**
   * CSS class names to apply to the container
   */
  class?: string
}

const {
  storyId,
  storybookUrl,
  height = 400,
  width = '100%',
  showToolbar = false,
  showPanel = false,
  title,
  class: className = '',
} = Astro.props
---

<div class={`storybook-embed-wrapper ${className}`}>
  <StorybookEmbed
    client:load
    storyId={storyId}
    storybookUrl={storybookUrl}
    height={height}
    width={width}
    showToolbar={showToolbar}
    showPanel={showPanel}
    title={title}
  />

  <!-- Fallback content for when JavaScript is disabled -->
  <noscript>
    <div class="storybook-fallback">
      <p>Interactive Storybook demo requires JavaScript.</p>
      <a href={storybookUrl || 'http://localhost:6006'} target="_blank" rel="noopener noreferrer">
        View story: {storyId} in Storybook â†’
      </a>
    </div>
  </noscript>
</div>

<style>
  .storybook-embed-wrapper {
    margin: 1rem 0;
    border-radius: 8px;
    overflow: hidden;
  }

  .storybook-fallback {
    padding: 2rem;
    text-align: center;
    background-color: var(--sl-color-bg-sidebar);
    border: 1px solid var(--sl-color-hairline-shade);
    border-radius: 8px;
  }

  .storybook-fallback a {
    color: var(--sl-color-text-accent);
    text-decoration: none;
    font-weight: 500;
  }

  .storybook-fallback a:hover {
    text-decoration: underline;
  }

  /* Responsive adjustments with Sparkle design tokens */
  @media (max-width: 768px) {
    .storybook-embed-wrapper {
      margin: var(--sparkle-spacing-sm) 0;
      border-radius: var(--sparkle-border-radius-sm);
    }

    .storybook-fallback {
      padding: var(--sparkle-spacing-md);
      font-size: var(--sparkle-font-size-sm);
    }
  }

  /* Tablet adjustments */
  @media (min-width: 768px) and (max-width: 1024px) {
    .storybook-embed-wrapper {
      margin: var(--sparkle-spacing-md) 0;
    }
  }

  /* Large screen optimizations */
  @media (min-width: 1280px) {
    .storybook-embed-wrapper {
      margin: var(--sparkle-spacing-lg) 0;
      border-radius: var(--sparkle-border-radius-lg);
    }
  }
</style>
